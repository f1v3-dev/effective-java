# 2장. 객체 생성과 파괴

**목표**

- 객체를 만드러야 할 때와 만들지 말아야 할 때를 구분
- 올바른 객체 생성과 불필요한 생성을 피하는 방법
- 제때 파괴됨을 보장하고 파괴 전에 수행해야 할 정리 작업을 관리하는 요령


### 1. 생성자 대신 정적 팩터리 메서드를 고려하라

**장점**

1. 이름을 가질 수 있다. 
2. 호출될 때마다 인스턴스를 새로 생성하지 않아도 된다.
3. 반환 타입의 하위 타입 객체를 반활할 수 있는 능력이 있다.
4. 입력 매개변수에 따라 매번 다른 클래스의 객체를 반환할 수 있다.
5. 정적 팩터리 메서드를 작성하는 시점에는 반환할 객체의 클래스가 존재하지 않아도 된다.

**단점**

1. 상속을 하려면 `public` 이나 `protected` 생성자가 필요하다.
2. 정적 팩터리 메서드는 프로그래머가 찾기 어렵다.

정적 팩터리 메서드와 public constructor 각자의 쓰임이 존재하니 어떤 방식이 더 유리한지 생각해보자.

### 2. 생성자에 매개변수가 많다면 빌더를 고려하라

매개변수가 많아질수록 코드를 작성하거나 읽기 어려워진다. 
자바빈즈 패턴(Setter)를 사용하기도 하지만, 객체가 완전히 생성되기 전까지 일관성(consistency)이 무너진 상태로 놓인다.

빌더 패턴을 사용하여 많은 매개변수를 처리해야할 경우 코드를 읽고 쓰기 간결하고 더 안전하게 객체를 만들어보자.

### 3. private 생성자를 잘 활용하라 (싱글턴, 인스턴스화)

private 생성자나 enum 타입으로 싱글턴임을 보증하자.
특히, 유틸리티 클래스와 같이 인스턴스화를 막으려는 경우 private 생성자를 사용하여 클래스의 인스턴스화를 막아 컴파일러가 자동으로 생성하는 public 생성자를 방지하자.

### 4. 다 쓴 객체 참조를 해제하라

사용이 끝난 객체에 대해 참조를 해제하지 않는다면, 메모리 누수가 발생할 수 있다.
물론, 가비지 컬렉션을 통해 자동으로 참조를 해제해주기는 하지만, 가비지 컬렉터가 불필요한 객체임을 인지하지 못하는 경우 null로 선언하여 알려주자.

> ex. Stack 의 `pop` 메서드 

### 5. try-with-resources 사용하라

try-finally 를 통해 자원을 관리했던 과거의 방식보다는, 자바 7부터 제공해주는 `try-with-resources` 를 통해 자원을 관리하자.

닫아야 하는 자원을 뜻하는 클래스를 작성한다면 `AutoCloseable` 을 반드시 구현하자. 코드는 더 짧고 분명해지고, 만들어지는 예외 정보도 훨씬 유용하다.
